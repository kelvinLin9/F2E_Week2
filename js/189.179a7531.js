"use strict";(self["webpackChunkf2e_week2"]=self["webpackChunkf2e_week2"]||[]).push([[189],{6637:function(e,t,i){i(7658);var n=i(2578),s=i(1120),o=i(6294);(0,o.Z)();t["Z"]=(0,n.Q_)("signStore",{state:()=>({signs:[],signMethod:"handwriting",imagePreview:"",color:"black"}),actions:{getSign(){this.signs=JSON.parse(localStorage.getItem("signs"))||[];const e=document.querySelector("#canvasImage"),t=e.getContext("2d"),i=document.querySelector(".clear");t.lineWidth=4,t.lineCap="round",t.strokeStyle=this.color;let n=!1;function s(t){const i=e.getBoundingClientRect();return"mousemove"===t.type?{x:t.clientX-i.left,y:t.clientY-i.top}:{x:t.touches[0].clientX-i.left,y:t.touches[0].clientY-i.top}}function o(e){e.preventDefault(),n=!0}function a(){n=!1,t.beginPath()}function r(e){if(!n)return;const i=s(e);t.lineTo(i.x,i.y),t.stroke()}function l(){t.clearRect(0,0,e.width,e.height)}e.addEventListener("mousedown",o),e.addEventListener("mouseup",a),e.addEventListener("mouseleave",a),e.addEventListener("mousemove",r),e.addEventListener("touchstart",o),e.addEventListener("touchend",a),e.addEventListener("touchcancel",a),e.addEventListener("touchmove",r),i.addEventListener("click",l)},saveImage(){if("handwriting"===this.signMethod){const e=document.querySelector("#canvasImage");this.signs.push(e.toDataURL("image/png")),localStorage.setItem("signs",JSON.stringify(this.signs)),this.reset()}else this.signs.push(this.imagePreview),localStorage.setItem("signs",JSON.stringify(this.signs)),this.imagePreview=""},removeImage(e){this.signs.splice(this.signs.indexOf(e),1),localStorage.setItem("signs",JSON.stringify(this.signs))},reset(){const e=document.querySelector("#canvasImage"),t=e.getContext("2d");t.clearRect(0,0,e.width,e.height)},gotoEditPDF(){s.Z.push("/UserSign/EditPDF")},async handleFileUpload(e){try{const t=e.target.files[0];if(!t)return;const i=await this.beforeUpload(t);if(!i.isValid)throw i.errorMessages;this.to64(t)}catch(t){alert(t),console.log("Catch Error: ",t)}finally{e.target.value=""}},beforeUpload(e){return new Promise((t=>{const i=["image/jpeg","image/png"],n=i.includes(e.type),s=[];n||s.push("You can only upload JPG or PNG file!");const o=e.size/1024/1024<2;o||s.push("Image must smaller than 2MB!"),t({isValid:n&&o,errorMessages:s.join("\n")})}))},showPreviewImage(e){const t=URL.createObjectURL(e);this.imagePreview=t},to64(e){const t=new FormData;t.append("iFile",e);const i=t.get("iFile"),n=new FileReader,s=i.type;n.readAsDataURL(i),n.onload=e=>{/^image\/[jpeg|png|gif]/.test(s)&&(console.log(e.target.result),this.imagePreview=e.target.result)}}}})},6294:function(e,t,i){var n=i(2578);t["Z"]=(0,n.Q_)("statusStore",{state:()=>({isLoading:!1,signHistoryView:!1}),actions:{}})},7189:function(e,t,i){i.r(t),i.d(t,{default:function(){return x}});var n=i(3396),s=i(7139),o=i(9242);const a=e=>((0,n.dD)("data-v-1ccdf08c"),e=e(),(0,n.Cn)(),e),r={class:"position-relative d-flex flex-column justify-content-center align-items-center Noto-Sans-TC"},l={class:"mt-5"},c={key:0,class:"d-flex"},g={class:"sign-here"},d=a((()=>(0,n._)("canvas",{id:"canvasImage",width:"590",height:"224"},null,-1))),u=[d],h={class:"upload-img-here"},m=a((()=>(0,n._)("label",{for:"upload",class:"cursor-pointer upload-file-label",accept:"image/png, image/jpeg"}," 請選擇檔案 ",-1))),p=["src"],v={class:"btn-group"},y=a((()=>(0,n._)("button",{type:"button",class:"clear btn btn-outline-primary px-5 mx-5 py-2 my-3 rounded-3 bg-white"}," 清除 ",-1)));function w(e,t,i,a,d,w){return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",l,[(0,n._)("button",{type:"button",class:(0,s.C_)(["btn py-2 my-3",{"btn-handwriting":"handwriting"===e.signMethod,"btn-import":"uploadImage"===e.signMethod}]),onClick:t[0]||(t[0]=t=>e.signMethod="handwriting")}," 手寫簽名 ",2),(0,n._)("button",{type:"button",class:(0,s.C_)(["btn py-2 my-3",{"btn-handwriting":"uploadImage"===e.signMethod,"btn-import":"handwriting"===e.signMethod}]),onClick:t[1]||(t[1]=t=>e.signMethod="uploadImage")}," 匯入簽名檔 ",2)]),"handwriting"===this.signMethod?((0,n.wg)(),(0,n.iD)("div",c,[(0,n._)("div",{class:(0,s.C_)(["choose-color black mx-2 my-4 cursor-pointer",{"black-active":"black"===e.color}]),onClick:t[2]||(t[2]=t=>(e.color="black",e.getSign()))},null,2),(0,n._)("div",{class:(0,s.C_)(["choose-color blue mx-2 my-4 cursor-pointer",{"blue-active":"blue"===e.color}]),onClick:t[3]||(t[3]=t=>(e.color="blue",e.getSign()))},null,2),(0,n._)("div",{class:(0,s.C_)(["choose-color red mx-2 my-4 cursor-pointer",{"red-active":"red"===e.color}]),onClick:t[4]||(t[4]=t=>(e.color="red",e.getSign()))},null,2)])):(0,n.kq)("",!0),(0,n.wy)((0,n._)("div",g,u,512),[[o.F8,"handwriting"===this.signMethod]]),(0,n.wy)((0,n._)("div",h,[m,(0,n._)("input",{type:"file",id:"upload",accept:"image/png, image/jpeg",class:"cursor-pointer upload-file",name:"file-upload",onChange:t[5]||(t[5]=t=>e.handleFileUpload(t))},null,32),e.imagePreview?((0,n.wg)(),(0,n.iD)("img",{key:0,src:e.imagePreview,alt:"預覽圖",class:"preview"},null,8,p)):(0,n.kq)("",!0)],512),[[o.F8,"uploadImage"===this.signMethod]]),(0,n._)("div",v,[y,(0,n._)("button",{type:"button",class:"save btn btn-primary px-5 mx-5 py-2 my-3 rounded-3 text-white",onClick:t[6]||(t[6]=t=>e.saveImage())}," 儲存 "),(0,n._)("button",{type:"button",class:"goto-editPDF btn btn-primary px-5 mx-5 py-2 my-3 rounded-3 text-white",onClick:t[7]||(t[7]=t=>(e.gotoEditPDF(),e.signHistoryView=!1))}," 下一步 ")])])}var f=i(2578),b=i(6637),_=i(6294),k={data(){return{}},computed:{...(0,f.Ah)(b.Z,["signMethod","imagePreview","color"]),...(0,f.Ah)(_.Z,["signHistoryView"])},methods:{...(0,f.nv)(b.Z,["getSign","saveImage","reset","handleFileUpload","gotoEditPDF"])},mounted(){this.getSign()}},S=i(89);const C=(0,S.Z)(k,[["render",w],["__scopeId","data-v-1ccdf08c"]]);var x=C}}]);
//# sourceMappingURL=189.179a7531.js.map